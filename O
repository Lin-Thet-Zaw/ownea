// --- Volatility Filter Inputs ---
input bool   UseVolatilityFilter = true;
input int    ATRPeriod           = 14;
input double MaxATR              = 120;   // ATR threshold in pips (adjust for gold)

// Helper to calculate ATR in pips
double GetATR(int period)
{
   return iATR(Symbol(), PERIOD_M5, ATRPeriod, 1) / _Point / (Digits==3||Digits==5 ? 10 : 1);
}



// --- VOLATILITY FILTER ---
   if(UseVolatilityFilter)
   {
      double atr = GetATR(ATRPeriod);
      if(atr > MaxATR)
      {
         Print("⚠️ ATR=", atr, " > MaxATR(", MaxATR, ") → Market too volatile, no trade.");
         return;
      }
   }
